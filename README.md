# Проектирование архитектуры хранилища файлов (аналог Dropbox, Google Drive, Yandex.Disk)

## Как проект генерирует прибыль
Хранилище файлов зарабатывает на:
- **Подписках**: предоставление дополнительного объема хранилища, премиум-функций (например, восстановление удаленных данных, история версий файлов).
- **Корпоративных тарифах**: услуги для бизнеса с возможностью управления доступом, совместной работы и аналитики.
- **Интеграциях**: платные API для сторонних разработчиков и компаний.

## Пользователи сервиса
1. **Обычные пользователи**: загружают и хранят свои файлы, делятся ссылками на них.
2. **Бизнес-пользователи**: используют хранилище для совместной работы и управления проектами.
3. **Разработчики**: используют API для интеграции хранилища в свои приложения.

## User Stories

1. **Обычный пользователь**:
   - Как пользователь, я хочу загружать и скачивать файлы, чтобы иметь доступ к ним с любого устройства.
   - Как пользователь, я хочу делиться ссылками на файлы, чтобы отправлять их коллегам или друзьям.

2. **Бизнес-пользователь**:
   - Как бизнес-пользователь, я хочу предоставлять доступ к файлам сотрудникам и ограничивать их права, чтобы безопасно делиться данными.
   - Как бизнес-пользователь, я хочу видеть изменения в файлах в режиме реального времени, чтобы отслеживать совместную работу.

3. **Разработчик**:
   - Как разработчик, я хочу интегрировать сервис хранилища файлов через API, чтобы использовать его функционал в своих приложениях.

## Архитектура и интерфейсы проекта

### Основные интерфейсы
- **Мобильное приложение**: для загрузки и управления файлами.
- **Веб-приложение**: доступ к хранилищу через браузер.
- **API**: для разработчиков и сторонних интеграций.

### Основные сервисы
1. **Сервис пользователей**: регистрация, аутентификация, управление профилем.
2. **Сервис файлов**: загрузка, скачивание, управление файлами.
3. **Сервис управления доступом**: настройки прав на файлы и папки.
4. **Сервис синхронизации**: синхронизация данных между устройствами.
5. **Сервис уведомлений**: отправка уведомлений о событиях (изменение файла, запрос доступа).
6. **Сервис аналитики**: сбор данных об использовании.
7. **Сервис платежей**: управление подписками и оплатой.

## Подробное описание сервисов

### Сервис пользователей
- **Методы**:
  - `POST /users/register`: регистрация нового пользователя.
  - `POST /users/login`: аутентификация.
  - `GET /users/profile`: получение информации о пользователе.
- **База данных**: `UserDB` (PostgreSQL) для хранения профилей.
- **Протокол**: REST API.

### Сервис файлов
- **Методы**:
  - `POST /files/upload`: загрузка файла.
  - `GET /files/download/{file_id}`: скачивание файла.
  - `DELETE /files/{file_id}`: удаление файла.
- **База данных**: `FileDB` (например, MongoDB для метаданных), хранилище (S3 или аналог).
- **Протокол**: REST API.

### Сервис управления доступом
- **Методы**:
  - `POST /access/share`: предоставление доступа к файлу.
  - `GET /access/{file_id}`: список пользователей с доступом.
- **База данных**: `AccessDB` для хранения прав.
- **Протокол**: REST API.

### Сервис синхронизации
- **Методы**:
  - `POST /sync/register`: регистрация устройства.
  - `GET /sync/updates`: получение изменений.
- **База данных**: `SyncDB` для отслеживания состояния устройств.
- **Протокол**: WebSocket для уведомлений.

### Сервис уведомлений
- **Методы**:
  - `POST /notifications/send`: отправка уведомлений.
  - `GET /notifications/{user_id}`: получение списка уведомлений.
- **База данных**: `NotificationDB`.
- **Протокол**: WebSocket и REST API.

### Сервис аналитики
- **Методы**:
  - `POST /analytics/event`: запись события.
  - `GET /analytics/report`: генерация отчета.
- **База данных**: `AnalyticsDB` (ClickHouse).
- **Протокол**: REST API.

### Сервис платежей
- **Методы**:
  - `POST /payments/subscribe`: оформление подписки.
  - `GET /payments/status`: проверка подписки.
- **База данных**: `PaymentDB`.
- **Протокол**: REST API.

## Протоколы межсервисного взаимодействия
- **REST API**: основной протокол для взаимодействия.
- **WebSocket**: для уведомлений и синхронизации.
- **Очереди сообщений** (RabbitMQ): для обмена событиями между аналитикой и другими сервисами.
